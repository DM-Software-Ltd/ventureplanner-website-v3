{% load static %}
<div class="our-services-silver bg-section">
    <div class="container">
        <div class="row section-row">
            <div class="col-lg-12">
                {% include 'partials/sitewide/section-title.html' with center=True subtitle="Our Plans" title="Choose the Perfect Plan for Your Business Needs" %}
            </div>
        </div>

        <!-- Sort Controls -->
        <div class="row">
            <div class="col-lg-12">
                <div class="sort-controls">
                    <button id="sortToggleBtn" class="sort-toggle-btn">
                        <i class="fi fi-tr-sort-alt"></i>
                        <span>Sort</span>
                    </button>
                    <div id="sortDropdown" class="sort-dropdown">
                        <button class="sort-option" data-sort="default">Default</button>
                        <button class="sort-option" data-sort="time">Time (Shortest First)</button>
                        <button class="sort-option" data-sort="popularity">Popularity</button>
                        <button class="sort-option" data-sort="marketing">Marketing Plans</button>
                        <button class="sort-option" data-sort="business">Business Plans</button>
                        <button class="sort-option" data-sort="financial">Financial Plans</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="right-panel-grid" id="allPlansGrid">
            {% for plan in all_plans %}
            <a href="{% url 'plan_detail' slug=plan.subTypeKey %}"
               class="plan-option {{ plan.planKey }}"
               data-plan-type="{{ plan.planKey }}"
               data-time="{{ plan.estimatedTime }}"
               data-popular="{{ plan.popular|yesno:'1,0' }}">
                <div class="plan-option__inner">
                    <!-- Left Visual -->
                    <div class="plan-option__inner--render">
                        {% if plan.thumb %}
                        <img
                           src="{% static plan.thumb %}"
                           alt="{{ plan.shortDescription }}"
                           loading="lazy"
                        >
                        {% else %}
                        <img
                           src="{% static 'images/business-plan-financial-charts.svg' %}"
                           alt="{{ plan.shortDescription }}"
                           loading="lazy"
                        >
                        {% endif %}
                        {% if plan.popular %}
                        <div class="popular-badge">
                            <div class="badge-text">Popular</div>
                        </div>
                        {% endif %}
                    </div>

                    <!-- Right Panel -->
                    <div class="plan-option__inner--overlay">
                        <div class="plan-option__inner--overlay__title">
                            {{ plan.label }}
                            <span class="fw-light d-block">{{ plan.label }}</span>
                        </div>

                        <div class="plan-option__inner--overlay__for">
                            {{ plan.shortDescription }}
                        </div>

                        <div class="plan-option__inner--overlay__time">
                            <div class="plans-time-needed">
                                <i class="fi fi-tr-pending"></i>{{ plan.estimatedTime }}
                            </div>
                        </div>

                        <div class="plan-option__inner--overlay__icon">
                            {% if plan.planKey == 'business' %}
                            <img class="icon" src="{% static 'images/icon-bp.svg' %}" alt="business plan icon" loading="lazy">
                            {% elif plan.planKey == 'financial' %}
                            <img class="icon" src="{% static 'images/icon-fp.svg' %}" alt="financial plan icon" loading="lazy">
                            {% else %}
                            <img class="icon" src="{% static 'images/icon-mp.svg' %}" alt="marketing plan icon" loading="lazy">
                            {% endif %}
                        </div>
                    </div>
                </div>
            </a>
            {% empty %}
            <p>No plans available.</p>
            {% endfor %}
        </div>
    </div>
</div>