{% load static %}

<!-- Our Project Section -->
<div class="our-project-silver">
    <div class="container-lg">
        <div class="row section-row">
            <div class="col-lg-12">
                {% include 'partials/sitewide/section-title.html' with subtitle="Example Plans" title="Explore Our Data-Driven Blueprints, Tailored for Every Stage of Growth" center=True %}
            </div>
        </div>

        <div class="row" id="plansTableSortControlsRow" style="display: none;">
            <div class="col-lg-12">
                <div class="sort-controls">
                    <button id="plansTableSortToggleBtn" class="sort-toggle-btn">
                        <i class="fi fi-tr-sort-alt"></i>
                        <span>Sort</span>
                    </button>
                    <div id="plansTableSortDropdown" class="sort-dropdown">
                        <button class="sort-option" data-sort="default">Default</button>
                        <button class="sort-option" data-sort="type">Plan Type</button>
                        <button class="sort-option" data-sort="time">Time (Shortest First)</button>
                        <button class="sort-option" data-sort="pages">Pages (Fewest First)</button>
                        <button class="sort-option" data-sort="strategic">Strategic Level</button>
                        <button class="sort-option" data-sort="tactical">Tactical Level</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="table-card">
            <div class="table-responsive">
                <table class="data-table">
                    <thead>
                    <tr>
                        <th class="text-left">Plan Details</th>
                        <th class="text-left">Type</th>
                        <th class="text-center">Strategic</th>
                        <th class="text-center">Tactical</th>
                        <th class="text-center">Time</th>
                        <th class="text-center">Pages</th>
                        <th class="text-center">Actions</th>
                    </tr>
                    </thead>
                    <tbody id="plansTableBody">
                    {% for plan in plans %}
                    <tr class="{% if forloop.counter > 6 %}plan-row-hidden{% endif %}"
                        data-original-order="{{ forloop.counter }}"
                        data-type="{{ plan.type }}"
                        data-time="{{ plan.time }}"
                        data-pages="{{ plan.pages }}"
                        data-strategic="{{ plan.strat_meta.bars }}"
                        data-tactical="{{ plan.tact_meta.bars }}">
                        <td class="cell-details">
                            {% if plan.type == "Business Plan" %}
                            <img class="icon" src="/static/images/icon-bp.svg" alt="business plan icon">
                            {% elif plan.type == "Marketing Plan" %}
                            <img class="icon" src="/static/images/icon-mp.svg" alt="marketing plan icon">
                            {% else %}
                            <img class="icon" src="/static/images/icon-fp.svg" alt="financial plan icon">
                            {% endif  %}
                            <div class="details-wrapper">
                                <div class="details-title">{{ plan.title }}</div>
                                <div class="details-desc">{{ plan.description }}</div>
                            </div>
                        </td>

                        <td>
                            <div class="sectors-wrapper">
                                {% for sector in plan.sectors %}
                                <span class="badge badge-{{ plan.type_slug }}">{{ sector }}</span>
                                {% endfor %}
                            </div>
                        </td>

                        <td class="cell-center">
                            <div class="signal-wrapper">
                                <div class="signal-bars">
                                    <div class="signal-bar {% if plan.strat_meta.bars >= 1 %}signal-bar-filled-{{ plan.strat_meta.class }}{% else %}signal-bar-empty{% endif %}"></div>
                                    <div class="signal-bar {% if plan.strat_meta.bars >= 2 %}signal-bar-filled-{{ plan.strat_meta.class }}{% else %}signal-bar-empty{% endif %}"></div>
                                    <div class="signal-bar {% if plan.strat_meta.bars >= 3 %}signal-bar-filled-{{ plan.strat_meta.class }}{% else %}signal-bar-empty{% endif %}"></div>
                                </div>
                                <span class="signal-label text-{{ plan.strat_meta.class }}">
                                  {{ plan.strat_meta.text }}
                                </span>
                            </div>
                        </td>
                        <td class="cell-center">
                            <div class="signal-wrapper">
                                <div class="signal-bars">
                                    <div class="signal-bar {% if plan.tact_meta.bars >= 1 %}signal-bar-filled-{{ plan.tact_meta.class }}{% else %}signal-bar-empty{% endif %}"></div>
                                    <div class="signal-bar {% if plan.tact_meta.bars >= 2 %}signal-bar-filled-{{ plan.tact_meta.class }}{% else %}signal-bar-empty{% endif %}"></div>
                                    <div class="signal-bar {% if plan.tact_meta.bars >= 3 %}signal-bar-filled-{{ plan.tact_meta.class }}{% else %}signal-bar-empty{% endif %}"></div>
                                </div>
                                <span class="signal-label text-{{ plan.tact_meta.class }}">
                                  {{ plan.tact_meta.text }}
                                </span>
                            </div>
                        </td>
                        <td class="cell-center">{{ plan.time }}</td>
                        <td class="cell-center">{{ plan.pages }}</td>
                        <td class="cell-center">
                            <div class="actions">
                                <a href="/contact/" class="d-flex flex-row gap-1">
                                    <i class="fi fi-tr-file-download"></i> <span>Download</span>
                                </a>
                                <a href="/contact/" class="d-flex flex-row gap-1 text-sm">
                                    <i class="fi fi-tr-overview"></i> <span>View</span>
                                </a>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>

        {% if plans|length > 6 %}
        <div class="col-lg-12">
            <div class="show-more-btn-container">
                <button id="togglePlansTableBtn" class="btn-show-more btn-default">
                    <span class="show-text">Show All Plans</span>
                    <span class="hide-text" style="display: none;">Show Less</span>
                </button>
            </div>
        </div>
        {% endif %}

        <div class="col-lg-12">
            <div class="section-footer-text wow fadeInUp" data-wow-delay="0.4s">
                <p>
                    Your roadmap to success is waiting -
                    <a href="{% url 'contact' %}">{{ MAIN_CTA_TEXT }}</a>
                </p>
            </div>
        </div>
    </div>
</div>
